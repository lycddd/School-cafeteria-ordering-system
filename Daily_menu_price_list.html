<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .nav {
            height: 65px;
            border-bottom: 3px black solid;
        }

        .nav h1 {
            margin-top: 0;
            width: 20%;
            float: left;
        }

        .nav ul {
            margin-top: 0;
            width: 100%;
        }

        .nav ul li {
            width: 20%;
            float: left;
            text-align: center;
            list-style: none;
        }

        .menu_table {}

        .menu_table table {
            float: left;
            width: 80%;
            margin-left: 10%;
        }

        .menu_table table tr {}

        .menu_table table tr th {
            width: 10%;
            text-align: center;
        }

        .menu_table table tr td {
            width: 8%;
            text-align: center;
        }

        .menu_table a {
            background-color: darkgray;
            margin-left: 46%;
            float: left;
            width: 7%;
            height: 30px;
            text-align: center;
            cursor: pointer;
        }


        .menu_change {
            margin-left: 10%;
            float: left;
            width: 80%;
            text-align: center;
        }

        .span {
            float: left;
            width: 20%;
        }
    </style>
</head>

<body>
    <div class="nav">
        <h1>食堂订菜系统</h1>
        <br>
        <ul>
            <a href="School_information.html">
                <li>学校信息</li>
            </a>
            <a href="Daily_menu_price_list.html">
                <li>每日菜品价目表</li>
            </a>
            <a href="Export.html">
                <li>导出汇总</li>
            </a>
            <a href="">
                <li>退出登录</li>
            </a>
        </ul>
    </div>

    <div id="menu_table" class="menu_table" style="display: '';">
        <table id="table_1">
            <tr>
                <th>日期</th>
                <th>菜名</th>
                <th>描述</th>
                <th>数量</th>
                <th>报价</th>
                <th>单位</th>
                <th>总价</th>
                <th>是否付款</th>
                <th style="width: 20%;">操作</th>
            </tr>
            <tr id="tr_1" style="display:'';">
                <td>1月1日</td>
                <td>炸鸡</td>
                <td>麻辣</td>
                <td>100</td>
                <td>20</td>
                <td>rmb</td>
                <td>2000</td>
                <td>否</td>
                <td style="text-align: left;">
                    <a id="tr_1_a1" onclick="tr_change(1,0)"
                        style="width: 40%;margin-left: 10%;background-color: white;color: blue;">修改</a>
                    <a id="tr_1_a2" onclick="tr_delete(1,0)"
                        style="width: 40%;margin-left: 10%;background-color: white;color: red;">删除</a>
                </td>
            </tr>
            <tr id="tr_2" style="display: none;">
                <td>2</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td style="text-align: left;">
                    <a id="tr_2_a1" onclick="tr_change(2,0)"
                        style="width: 40%;margin-left: 10%;background-color: white;color: blue;">修改</a>
                    <a id="tr_2_a2" onclick="tr_delete(2,0)"
                        style="width: 40%;margin-left: 10%;background-color: white;color: red;">删除</a>
                </td>
            </tr>
            <tr id="tr_3" style="display: none;">
                <td>3</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td style="text-align: left;">
                    <a id="tr_3_a1" onclick="tr_change(3,0)"
                        style="width: 40%;margin-left: 10%;background-color: white;color: blue;">修改</a>
                    <a id="tr_3_a2" onclick="tr_delete(3,0)"
                        style="width: 40%;margin-left: 10%;background-color: white;color: red;">删除</a>
                </td>
            </tr>
            <tr id="tr_4" style="display: none;">
                <td>4</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td style="text-align: left;">
                    <a id="tr_4_a1" onclick="tr_change(4,0)"
                        style="width: 40%;margin-left: 10%;background-color: white;color: blue;">修改</a>
                    <a id="tr_4_a2" onclick="tr_delete(4,0)"
                        style="width: 40%;margin-left: 10%;background-color: white;color: red;">删除</a>
                </td>
            </tr>
            <tr id="tr_5" style="display: none;">
                <td>5</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td style="text-align: left;">
                    <a id="tr_5_a1" onclick="tr_change(5,0)"
                        style="width: 40%;margin-left: 10%;background-color: white;color: blue;">修改</a>
                    <a id="tr_5_a2" onclick="tr_delete(5,0)"
                        style="width: 40%;margin-left: 10%;background-color: white;color: red;">删除</a>
                </td>
            </tr>
            <tr id="tr_6" style="display: none;">
                <td>6</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td style="text-align: left;">
                    <a id="tr_6_a1" onclick="tr_change(6,0)"
                        style="width: 40%;margin-left: 10%;background-color: white;color: blue;">修改</a>
                    <a id="tr_6_a2" onclick="tr_delete(6,0)"
                        style="width: 40%;margin-left: 10%;background-color: white;color: red;">删除</a>
                </td>
            </tr>
            <tr id="tr_7" style="display: none;">
                <td>7</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td style="text-align: left;">
                    <a id="tr_7_a1" onclick="tr_change(7,0)"
                        style="width: 40%;margin-left: 10%;background-color: white;color: blue;">修改</a>
                    <a id="tr_7_a2" onclick="tr_delete(7,0)"
                        style="width: 40%;margin-left: 10%;background-color: white;color: red;">删除</a>
                </td>
            </tr>
            <tr id="tr_8" style="display: none;">
                <td>8</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td style="text-align: left;">
                    <a id="tr_8_a1" onclick="tr_change(8,0)"
                        style="width: 40%;margin-left: 10%;background-color: white;color: blue;">修改</a>
                    <a id="tr_8_a2" onclick="tr_delete(8,0)"
                        style="width: 40%;margin-left: 10%;background-color: white;color: red;">删除</a>
                </td>
            </tr>
            <tr id="tr_9" style="display: none;">
                <td>9</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td style="text-align: left;">
                    <a id="tr_9_a1" onclick="tr_change(9,0)"
                        style="width: 40%;margin-left: 10%;background-color: white;color: blue;">修改</a>
                    <a id="tr_9_a2" onclick="tr_delete(9,0)"
                        style="width: 40%;margin-left: 10%;background-color: white;color: red;">删除</a>
                </td>
            </tr>
            <tr id="tr_10" style="display: none;">
                <td>10</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td style="text-align: left;">
                    <a id="tr_10_a1" onclick="tr_change(10,0)"
                        style="width: 40%;margin-left: 10%;background-color: white;color: blue;">修改</a>
                    <a id="tr_10_a2" onclick="tr_delete(10,0)"
                        style="width: 40%;margin-left: 10%;background-color: white;color: red;">删除</a>
                </td>
            </tr>
            <tr id="tr_11" style="display: none;">
                <td>11</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td style="text-align: left;">
                    <a id="tr_11_a1" onclick="tr_change(11,0)"
                        style="width: 40%;margin-left: 10%;background-color: white;color: blue;">修改</a>
                    <a id="tr_11_a2" onclick="tr_delete(11,0)"
                        style="width: 40%;margin-left: 10%;background-color: white;color: red;">删除</a>
                </td>
            </tr>
        </table>
        <span class="span"></span>
        <a onclick="add_tr()" type="button" >增加</a>

    </div>
    <span class="span"></span>
    <span class="span"></span>
    <div id="menu_change" class="menu_change" style="display: none;">
        <form id = 'form1' action="">
            <input id="t_row" value="h" style="display: none;" type="text">
            <input id="t_cell" value="" style="display: none;" type="text">
            日期：<input id="date_" type="text" value="hahah" name="date"><br /><br />
            菜名：<input id="dishname_" type="text" name="dishname"><br /><br />
            描述：<input id="describe_" type="text" name="describe"><br /><br />
            数量：<input id="num_" type="text" name="num"><br /><br />
            报价：<input id="price_" type="text" name="price"><br /><br />
            单位：<input id="unit_" type="text" name="unit"><br /><br />
            总价：<input id="total_" type="text" name="total"><br /><br />
            是否打款：<input id="ifpay_" type="text" name="ifpay"><br /><br />
            <a onclick="save()">保存</a>
        </form>
       
    </div>

    <script type="text/javascript">
        var num = 8; row_max = 11;
        a = 'tr_' + num;
        var x = document.getElementById(a);

        for (var i = 1; i <= num; i++) {
            b = 'tr_' + i;
            y = document.getElementById(b);
            y.style.display = '';
        }

        function add_tr() {
            if (num >= row_max) {
                return;
            }
            num = num + 1;
            a = 'tr_' + num;
            x = document.getElementById(a);

            if (x.style.display == 'none') {
                x.style.display = '';
            }
        }
        function decrease_tr() {
            x = document.getElementById(a);
            if (x.style.display == '') {
                x.style.display = 'none';
                x = document.getElementById(a);
                num = num - 1;
                a = 'tr_' + num;
            }
        }

        function tr_change(row, cell) {
            var row_change = document.getElementById("t_row"), cell_change = document.getElementById("t_cell");
            var date_change = document.getElementById("date_"), dishname_change = document.getElementById("dishname_"), describe_change = document.getElementById("describe_"), num_change = document.getElementById("num_"), price_change = document.getElementById("price_"), unit_change = document.getElementById("unit_"), total_change = document.getElementById("total_"), ifpay_change = document.getElementById("ifpay_"),
                date_table = document.getElementById("table_1").rows[row].cells[cell], dishname_table = document.getElementById("table_1").rows[row].cells[cell + 1], describe_table = document.getElementById("table_1").rows[row].cells[cell + 2], num_table = document.getElementById("table_1").rows[row].cells[cell + 3], price_table = document.getElementById("table_1").rows[row].cells[cell + 4], unit_table = document.getElementById("table_1").rows[row].cells[cell + 5], total_table = document.getElementById("table_1").rows[row].cells[cell + 6], ifpay_table = document.getElementById("table_1").rows[row].cells[cell + 7];
            document.getElementById("menu_change").style.display = '';
            document.getElementById("menu_table").style.display = 'none';
            date_change.value = date_table.innerText;
            dishname_change.value = dishname_table.innerText;
            describe_change.value = describe_table.innerText;
            num_change.value = num_table.innerText;
            price_change.value = price_table.innerText;
            total_change.value = total_table.innerText;
            unit_change.value = unit_table.innerText;
            ifpay_change.value = ifpay_table.innerText;
            row_change.value = row;
            cell_change.value = cell;

        }

        function tr_delete(row, cell) {

            for (; row < row_max; row = row + 1) {
                for (cell = 0; cell <= 7; cell = cell + 1) {
                    td_row = document.getElementById("table_1").rows[row].cells[cell];
                    td_rownext = document.getElementById("table_1").rows[row + 1].cells[cell];
                    td_row.innerText = td_rownext.innerText;
                }
            }

            for (cell = 0; cell <= 7; cell = cell + 1) {
                td_row = document.getElementById("table_1").rows[row].cells[cell];
                td_row.innerText = "";
            }
            decrease_tr();
        }

        function save() {
            var row = Number(document.getElementById("t_row").value), cell = Number(document.getElementById("t_cell").value) ;
            var date_change = document.getElementById("date_"), dishname_change = document.getElementById("dishname_"), describe_change = document.getElementById("describe_"), num_change = document.getElementById("num_"), price_change = document.getElementById("price_"), unit_change = document.getElementById("unit_"), total_change = document.getElementById("total_"), ifpay_change = document.getElementById("ifpay_"),
                date_table = document.getElementById("table_1").rows[row].cells[cell], dishname_table = document.getElementById("table_1").rows[row].cells[cell + 1], describe_table = document.getElementById("table_1").rows[row].cells[cell + 2], num_table = document.getElementById("table_1").rows[row].cells[cell + 3], price_table = document.getElementById("table_1").rows[row].cells[cell + 4], unit_table = document.getElementById("table_1").rows[row].cells[cell + 5], total_table = document.getElementById("table_1").rows[row].cells[cell + 6], ifpay_table = document.getElementById("table_1").rows[row].cells[cell + 7];

            date_table.innerText = date_change.value;
            dishname_table.innerText = dishname_change.value;
            describe_table.innerText = describe_change.value;
            num_table.innerText = num_change.value;
            price_table.innerText = price_change.value;
            unit_table.innerText = unit_change.value;
            total_table.innerText = total_change.value;
            ifpay_table.innerText = total_change.value;
            document.getElementById("menu_table").style.display = '';
            document.getElementById("menu_change").style.display = 'none';
                const date_ = document.getElementById("date_").value;
                const dishname_ = document.getElementById("dishname_").value;
                const describe_ = document.getElementById("describe_").value;
                const num_ = document.getElementById("num_").value;
                const price_ = document.getElementById("price_").value;
                const unit_ = document.getElementById("unit_").value;
                const total_ = document.getElementById("total_").value;
                const ifpay_ = document.getElementById("ifpay_").value;
                var json_data = new JSON.stringify({"date_":date_,"dishname_":dishname_,"describe_":describe_,"num_":num_,"price_":price_,"unit_":unit_,"total_":total_,"ifpay_":ifpay_});
                var xhr = new XMLHttpRequest();
                xhr.open("POST","http://127.0.0.1:5000/api/v1/categories");
                xhr.send(json_data);
                xhr.withCredentials = true;
                xhr.onreadystatechange=function(){
                    if(xhr.readyState == 4){
                        var response_data = JSON.parse(xhr.response);
                        if(response_data>=200 && response_data<300){
                            alert("操作成功！");
                        }
                        else{
                            alert("操作失败！");
                        }
                    }
                }
        }
    </script>
</body>

</html>