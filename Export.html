<!DOCTYPE html>
<html lang="en">
<head>
    <link href="Export.css" rel="stylesheet" type="text/css">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
       
    </style>
</head>
<body>
  <div class="anniu">
    <li><button class="button" data-file="daily-order">每日产品订货单</button></li>
    <li><button class="button" data-file="quotation">报价单</button></li>
    <li><button class="button" data-file="school-sales">学校销售汇总</button></li>
    <li><button class="button" data-file="customer-daily-sales">客户每日销售单</button></li>
    <li><button class="button" data-file="customer-monthly-sales">客户每月销售单</button></li>
    <li><button class="button" data-file="product-monthly-summary">月单个产品汇总图</button></li>
</div>
<script>
const anniuDiv = document.querySelector('.anniu');
const buttons = Array.from(document.querySelectorAll('.button'));

anniuDiv.addEventListener('click', async (event) => {
  const { target } = event;
  if (!target.matches('.button')) return;

  const file = target.dataset.file;
  const url = `/download/${file}`;
  const response = await fetch(url);
  const blob = await response.blob();
  
  const a = document.createElement('a');
  a.href = window.URL.createObjectURL(blob);
  a.download = `${file}.xlsx`;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
});
</script>
</body>
</html>